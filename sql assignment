
1.select A.film_id from (select film_id from film_category where category_id = (select category_id from category where name='Comedy'))A Inner Join (SELECT film_id FROM film  where rating='PG-13')B on A.film_id=B.film_id;


2.
create view horror_movie_film_id as select film_id from film_category where category_id=(select category_id from category where name="Horror");

select * from film_text join (select count(rental_id)as no_of_rentals,film_id from rental join (select * from inventory where film_id in (select * from horror_movie_film_id)) as inventory_horror_film on rental.inventory_id=inventory_horror_film.inventory_id group by inventory_horror_film.film_id order by no_of_rentals desc limit 3)as top_horror_rented on film_text.film_id=top_horror_rented.film_id;


3.select distinct customer_list.* from customer_list join (select rental.* from rental join (select inventory_id  from inventory where film_id in (select film_id from film_category where category_id=(select category_id from category where name="Sports")))as category_inventory on rental.inventory_id=category_inventory.inventory_id where rental.customer_id in(select ID from customer_list where country="India") )as table2 on customer_list.ID=table2.customer_id


4.select distinct customer_list.* from customer_list join (select rental.* from rental join (select inventory_id  from inventory where film_id in (select film_id from film_actor where actor_id=(select actor_id from actor where first_name='NICK' and last_name='WAHLBERG')))as actor_inventory on rental.inventory_id=actor_inventory.inventory_id where rental.customer_id in(select ID from customer_list where country="Canada") )as table2 on customer_list.ID=table2.customer_id

5.select count(*) from film_actor where actor_id = (select actor_id from actor where first_name="SEAN" and last_name="WILLIAMS");


1.select count(*) from film_list join film on film_list.FID=film.film_id where special_features like '%Deleted Scenes%' and category='Documentary';

2.
create view required_store as select SID from staff_list where name='Jon Stephens';
create view required_film_id as select FID from film_list where category='Sci-Fi';


select * from rental where inventory_id in (select inventory_id from inventory where store_id in (select * from required_store) and film_id in (select * from required_film_id))

3.select total_sales from sales_by_film_category where category = "ANIMATION";

4.select count(*)as rental_frequency,category_id from (select inventory_id,category_id from inventory join film_category on inventory.film_id=film_category.film_id)as inventory_category join (select rental_id,inventory_id from rental where customer_id = (select ID from customer_list where name='PATRICIA JOHNSON'))as rental_inventory on rental_inventory.inventory_id=inventory_category.inventory_id group by category_id order by rental_frequency desc limit 3

5.
select count(*)as count_freq from (select rental_id,inventory_id from rental join customer_list on  rental.customer_id=customer_list.id where name='SUSAN WILSON')as rental_inventory join (select inventory_id,inventory.film_id,rating from inventory join film on inventory.film_id=film.film_id)as invent_film on rental_inventory.inventory_id=invent_film.inventory_id where rating='R';


